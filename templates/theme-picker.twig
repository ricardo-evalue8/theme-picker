
{% extends '_base/_page-nav.twig' %}
{% block page_nav 'Theme picker' %}
{% block page_title 'Theme picker' %}
{% block page_main %}
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="{{ asset('css/card.css', 'theme') }}">
	<link rel="stylesheet" href="{{ asset('css/card.css', 'theme') }}">
</head>

{# Template picker #}
{#<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">#}
<link rel="stylesheet" href="{{ asset('css/card.css', 'theme') }}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

{% set themes = {'theme2': 'base-2016', 'theme3': 'skeleton', 'theme4': 'test'} %}
{% set themesInfo = {'info2': 'test2', 'info3': 'test3', 'info4': 'test4'} %}

<div class="container">

  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Confirm new theme</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p id="modal-text"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
          <button type="button" class="btn btn-primary" onclick="selectTheme()">Yes</button>
        </div>
      </div>
    </div>
  </div>


  <!-- Modal -->
  <div class="modal fade bd-example-modal-lg" id="themeModal" tabindex="-1" role="dialog" aria-labelledby="themeModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="themeModalLongTitle"></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p id="theme-modal-text"></p>
          <div class="row">
            <div class="col-6">
              <img id="image1" class="card-img-top" alt="{{ value }} image" style="max-height: 183.563px;">
            </div>
            <div class="col-6">
              <img id="image2" class="card-img-top" alt="{{ value }} image" style="max-height: 183.563px;">
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- cards -->
  <div class="row">
    <div class="col-4">
      <div class="card">
        <img class="card-img-top image" src="/theme/{{ config.get('general/theme') }}/theme.png" alt="Card image cap">
          <div class="card-body">
            <h5 class="card-title">{{ config.get('general/theme') }}</h5>
            <p class="card-text">{{ theme.info }}</p>
          </div>
          <div class="card-footer text-center">
              <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" style="cursor: not-allowed;" disabled> Active theme</button>
              <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#themeModal" value="{{ config.get('general/theme') }}" onclick="theme(this)">Theme info</button>
          </div>
      </div>
    </div>

    {% for key,value in themes %}
    <div class="col-4 mb-5">
      <div class="card">
        <img class="card-img-top" src="/theme/{{ value }}/theme.png" alt="{{ value }} image" style="max-height: 183.563px;" onerror="this.src='../..//files/main/no-image.png';">
          <div class="card-body">
              <h5 class="card-title">{{ value }}</h5>
            <p class="card-text">{{ theme.info }}</p>
          </div>
          <div class="card-footer text-center">
              <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" value="{{ value }}" onclick="data(this)">Select theme</button>
              <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#themeModal" value="{{ value }}" onclick="theme(this)">Theme info</button>
          </div>
      </div>
    </div>
    {% endfor %}

  </div>
</div>

<script>
// Get folder for images
// OnLoad
document.getElementById("theme-modal-text").innerHTML = "No theme info found";

function data(a) {
  var value = a.value;
  document.getElementById("modal-text").innerHTML = "Are you sure you want to use " + value + " as your new theme?";
}

function theme(e) {
  var value = e.value;

  var image = document.getElementById("image1");
  image.src = "/theme/" + value  + "/theme.png";

  var image2 = document.getElementById("image2");
  image2.src = "/theme/" + value  + "/screenshots/screenshot1.png";


  // Title
  document.getElementById("themeModalLongTitle").innerHTML = value;

  var path = "/theme/" + value  + "/text.txt";
  // Text
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      document.getElementById("theme-modal-text").innerHTML =
      this.responseText;
    }
  };
  xhttp.open("GET", path, true);
  xhttp.send();
}

$("#themeModal").on("hidden.bs.modal", function () {
    // Clear modal text
    document.getElementById("themeModalLongTitle").innerHTML = "";
    // Set text to No theme info found
    document.getElementById("theme-modal-text").innerHTML = "No theme info found";
});


function selectTheme() {
  alert("Not ready yet");
}
</script>

{% endblock %}
